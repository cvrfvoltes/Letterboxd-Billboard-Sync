from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
import time
import pandas as pd

# Path to the CSV file
csv_file_path = "C:/Users/fedev/OneDrive/Documentos/Letterboxd Showcase/extracted_movies.csv"

# User credentials
username = "fvoltes"  # Replace with your Letterboxd username
password = "mortalkombat9"  # Replace with your Letterboxd password

# Initialize Selenium WebDriver
driver = webdriver.Chrome()

try:
    # Open Letterboxd login page
    driver.get("https://letterboxd.com/sign-in/")
    time.sleep(2)

    # Log in
    driver.find_element(By.ID, "username").send_keys(username)
    driver.find_element(By.ID, "password").send_keys(password)
    driver.find_element(By.ID, "password").send_keys(Keys.RETURN)
    time.sleep(3)

    # Navigate to "Create a List" page
    driver.get("https://letterboxd.com/list/new/")
    time.sleep(2)

    # Input list title and description
    list_title = "Automated List"
    list_description = "This list was created automatically using Selenium and a CSV file."
    driver.find_element(By.NAME, "list-name").send_keys(list_title)
    driver.find_element(By.NAME, "list-description").send_keys(list_description)

    # Read movie titles from the CSV file
    movies_df = pd.read_csv(csv_file_path)
    movie_titles = movies_df["Title"]

    # Add movies to the list
    for title in movie_titles:
        search_box = driver.find_element(By.CSS_SELECTOR, "input[placeholder='Search for a filmâ€¦']")
        search_box.send_keys(title)
        time.sleep(2)  # Wait for search results to load
        search_box.send_keys(Keys.RETURN)
        time.sleep(1)  # Ensure the movie is added before proceeding

    # Save the list
    driver.find_element(By.CSS_SELECTOR, "button[type='submit']").click()
    time.sleep(3)

    print("List created successfully!")

finally:
    # Close the WebDriver
    driver.quit()
